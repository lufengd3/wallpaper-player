import { useState } from 'react';
import { getFavIconByUrl } from './utils';
import './index.css';

function DefaultSiteIcon() {
  return <svg t="1671264005332" className='favicon' viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4161" width="64" height="64"><path d="M511.968 128c-211.744 0-384 172.288-384 384s172.256 384 384 384C723.744 896 896 723.744 896 512S723.744 128 511.968 128z m101.312 718.368c7.104-7.392 14.112-15.936 21.472-25.984l1.888-2.624c14.144-19.872 26.624-42.464 38.08-69.152l4.544-11.68 5.056 2.464c21.472 10.432 41.536 23.36 59.616 38.368l4.768 3.968-4.736 4.032a355.04 355.04 0 0 1-125.344 69.184l-19.232 5.984 13.888-14.56z m80.448-316.544c-1.504 59.616-10.656 118.144-26.432 169.28l-1.6 5.28-5.216-1.984c-40.192-14.88-84.288-23.36-131.008-25.152l-5.056-0.192v-152.608h169.408l-0.096 5.376z m-36.064 197.856l-1.952 4.96c-30.72 78.112-75.136 126.624-125.024 136.544l-6.272 1.216v-168.48l5.44 0.256c43.904 1.792 85.216 9.728 122.784 23.68l5.024 1.824z m86.24-481.472a299.648 299.648 0 0 1-59.488 38.368l-6.08 0.672-2.016-5.632-2.592-6.592a362.944 362.944 0 0 0-37.152-66.88l-1.888-2.592a245.12 245.12 0 0 0-21.44-25.92l-13.888-14.624 19.2 5.984a355.392 355.392 0 0 1 125.344 69.216l4.736 4-4.736 4zM660.48 321.6l5.216-1.952 1.6 5.28c15.776 51.136 24.928 109.696 26.432 169.28l0.128 5.376h-169.408v-152.608l5.056-0.192c46.72-1.824 90.784-10.304 130.976-25.184z m-136.032 0.48V153.568l6.272 1.216c49.888 9.92 94.272 58.464 125.024 136.576l1.952 4.96-4.992 1.824c-37.536 13.92-78.848 21.888-122.784 23.712l-5.472 0.224z m242.016 442.848l-3.744-3.168a321.856 321.856 0 0 0-70.784-45.952l-4.256-2.016 3.008-8.608c8.576-27.296 15.296-56.032 19.936-85.408l1.6-11.648c1.632-11.68 2.976-23.488 3.968-35.04l1.088-13.312c0.512-7.2 0.704-14.688 0.896-21.888l0.384-13.44h152l-0.256 5.504a358.976 358.976 0 0 1-100.512 231.488l-3.328 3.488z m-50.24-313.984c-0.992-11.552-2.336-23.36-3.968-35.04l-1.6-11.616a591.36 591.36 0 0 0-20.192-86.144l-2.784-7.904 4.256-2.016a323.36 323.36 0 0 0 70.784-45.92l3.744-3.2 3.392 3.52a358.816 358.816 0 0 1 100.512 231.456l0.256 5.504h-152l-0.384-13.408a555.936 555.936 0 0 0-0.896-21.888l-1.12-13.344z m-305.504-273.28a251.008 251.008 0 0 0-21.44 25.952l-1.92 2.624a362.24 362.24 0 0 0-37.088 66.816l-5.504 14.048-5.088-2.464a296.832 296.832 0 0 1-59.584-38.4l-4.736-4 4.736-4a354.56 354.56 0 0 1 125.344-69.216l19.2-5.984-13.92 14.624z m-80.448 316.512c1.472-59.488 10.624-118.016 26.432-169.28l1.6-5.28 5.216 1.952c40.192 14.88 84.288 23.36 131.008 25.152l5.024 0.192v152.608h-169.376l0.096-5.344z m36.064-197.824l1.952-4.96c30.752-78.112 75.136-126.656 125.024-136.576l6.24-1.216v168.512l-5.44-0.224c-43.904-1.824-85.216-9.76-122.784-23.712l-4.992-1.824zM280.128 777.792a298.368 298.368 0 0 1 59.488-38.304l6.784 2.048 3.904 9.472c10.56 24.608 23.072 47.104 37.088 66.848l1.888 2.592c2.144 2.976 4.416 5.184 6.592 7.968 2.944 3.744 5.856 7.264 8.8 10.624 2.016 2.336 4.032 5.184 6.048 7.328l13.952 14.56-19.264-5.952a355.776 355.776 0 0 1-125.344-69.184l-4.736-4.032 4.8-3.968z m83.392-75.392l-5.216 1.984-1.6-5.28c-15.808-51.232-24.928-109.792-26.432-169.28l-0.128-5.376h169.376v152.608l-5.024 0.192c-46.72 1.792-90.784 10.24-130.976 25.152z m136.032-0.48V870.4l-6.24-1.216c-49.888-9.92-94.304-58.432-125.024-136.544l-1.952-4.96 4.992-1.856c37.6-13.92 78.912-21.888 122.784-23.68l5.44-0.224z m-187.776-286.016c-1.632 11.488-2.944 23.232-4.128 36.928l-0.928 11.392c-0.512 7.712-0.736 15.52-0.96 24.192l-0.32 11.104H153.408l0.256-5.504a358.592 358.592 0 0 1 100.48-231.456l3.392-3.52 3.744 3.2a322.72 322.72 0 0 0 70.688 45.888l2.88 6.144-1.504 4.544a589.952 589.952 0 0 0-19.968 85.472l-1.6 11.616z m0 192.192l1.6 11.616c4.704 29.76 11.456 58.528 19.968 85.44l2.88 8.672-4.16 1.952c-25.728 12.32-49.536 27.808-70.784 45.952l-3.744 3.168-3.392-3.52a358.816 358.816 0 0 1-100.48-231.488l-0.256-5.504h152.032l0.32 11.104c0.192 8.64 0.448 16.448 0.96 24.192l1.12 13.312c0.992 12.096 2.336 23.904 3.936 35.104z" fill="" p-id="4162"></path></svg>;
}

export default (props) => {
  const [error, setError] = useState(false);
  const icon = props.data.icon || getFavIconByUrl(props.data.url);

  function handleError() {
    setError(true);
  }

  return <>
      {icon && !error
      ? <img src={icon} className="favicon" onError={handleError} /> 
      : <DefaultSiteIcon />}
  </>;
}